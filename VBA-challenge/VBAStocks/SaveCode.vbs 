Sub StockCondenser1()Dim Module As StringDim Module2 As DoubleDim Module3 As DoubleDim RowInput As LongDim SheetsArray() As VariantSheetsArray = Array("A", "B", "C", "D", "E", "F", "P")RowInput = 2Module2 = 0        For sht = 0 To 6        Sheets(SheetsArray(sht)).Activate            For i = 2 To 70926                If Cells(i, 1).value <> Cells(i - 1, 1).value Then                    Module = Cells(i, 1).value                    Cells(RowInput, 9).value = Module                    RowInput = RowInput + 1                End If            Next i            RowInput = 2    Next sht    RowInput = 2            Sheets(SheetsArray(0)).Activate        For i = 2 To 70926            If Cells(i, 1).value = Cells(RowInput, 9).value Then                Module2 = (Cells(RowInput, 10).value + (Cells(i, 6).value - Cells(i, 3).value))                Module3 = (Cells(RowInput, 10).value + Cells(i, 3).value)                Cells(RowInput, 10).value = Module2                Cells(RowInput, 11).value = (Module2 / Module3) * 100            Else:                RowInput = RowInput + 1                Module3 = Cells(i, 3).value            End If        Next i        RowInput = 2            Sheets(SheetsArray(1)).Activate        For i = 2 To 48544            If Cells(i, 1).value = Cells(RowInput, 9).value Then                Module2 = (Cells(RowInput, 10).value + (Cells(i, 6).value - Cells(i, 3).value))                Module3 = (Cells(RowInput, 10).value + Cells(i, 3).value)                Cells(RowInput, 10).value = Module2                Cells(RowInput, 11).value = (Module2 / Module3) * 100            Else:                RowInput = RowInput + 1                Module3 = Cells(i, 3).value            End If        Next i        RowInput = 2                For i = 48545 To 70926            If Cells(i, 1).value = Cells(RowInput, 9).value Then                Module2 = (Cells(RowInput, 10).value + (Cells(i, 6).value - Cells(i, 3).value))                Module3 = (Cells(RowInput, 10).value + Cells(i, 3).value)                Cells(RowInput, 10).value = Module2                Cells(RowInput, 11).value = (Module2 / Module3) * 100            Else:                RowInput = RowInput + 1                Module3 = Cells(i, 3).value            End If        Next i        RowInput = 2                For sht = 2 To 3        Sheets(SheetsArray(sht)).Activate        For i = 2 To 70926            If Cells(i, 1).value = Cells(RowInput, 9).value Then                Module2 = (Cells(RowInput, 10).value + (Cells(i, 6).value - Cells(i, 3).value))                Module3 = (Cells(RowInput, 10).value + Cells(i, 3).value)                Cells(RowInput, 10).value = Module2                Cells(RowInput, 11).value = (Module2 / Module3) * 100            Else:                RowInput = RowInput + 1                Module3 = Cells(i, 3).value            End If        Next i        RowInput = 2    Next sht        Sheets(SheetsArray(4)).Activate        For i = 2 To 70926            If Cells(i, 1).value = Cells(RowInput, 9).value Then                Module2 = (Cells(RowInput, 10).value + (Cells(i, 6).value - Cells(i, 3).value))                Module3 = (Cells(RowInput, 10).value + Cells(i, 3).value)                Cells(RowInput, 10).value = Module2                Cells(RowInput, 11).value = (Module2 / Module3) * 100            Else:                RowInput = RowInput + 1                Module3 = Cells(i, 3).value            End If        Next i        RowInput = 2        Sheets(SheetsArray(5)).Activate        For i = 2 To 70926            If Cells(i, 1).value = Cells(RowInput, 9).value Then                Module2 = (Cells(RowInput, 10).value + (Cells(i, 6).value - Cells(i, 3).value))                Module3 = (Cells(RowInput, 10).value + Cells(i, 3).value)                Cells(RowInput, 10).value = Module2                Cells(RowInput, 11).value = (Module2 / Module3) * 100            Else:                RowInput = RowInput + 1                Module3 = Cells(i, 3).value            End If        Next i        RowInput = 2        Sheets(SheetsArray(6)).Activate        For i = 2 To 70926            If Cells(i, 1).value = Cells(RowInput, 9).value Then                Module2 = (Cells(RowInput, 10).value + (Cells(i, 6).value - Cells(i, 3).value))                Module3 = (Cells(RowInput, 10).value + Cells(i, 3).value)                Cells(RowInput, 10).value = Module2                Cells(RowInput, 11).value = (Module2 / Module3) * 100            Else:                RowInput = RowInput + 1                Module3 = Cells(i, 3).value            End If        Next i        RowInput = 2        For i = 27785 To 70926            If Cells(i, 1).value = Cells(RowInput, 9).value Then                Module2 = (Cells(RowInput, 10).value + (Cells(i, 6).value - Cells(i, 3).value))                Module3 = (Cells(RowInput, 10).value + Cells(i, 3).value)                Cells(RowInput, 10).value = Module2                Cells(RowInput, 11).value = (Module2 / Module3) * 100            Else:                RowInput = RowInput + 1                Module3 = Cells(i, 3).value            End If        Next i        RowInput = 2    For sht = 0 To 6        Sheets(SheetsArray(sht)).Activate            For i = 2 To 70926                If Cells(i, 1).value = Cells(RowInput, 9).value Then                    Cells(RowInput, 12).value = Cells(RowInput, 12).value + Cells(i, 7).value                Else:                    RowInput = RowInput + 1                End If            Next i            RowInput = 2    Next sht    RowInput = 2For sht = 0 To 6    Sheets(SheetsArray(sht)).Activate    Cells(1, 9).value = "Ticker"    Cells(1, 10).value = "Change (Raw)"    Cells(1, 11).value = "Change (%)"    Cells(1, 12).value = "Total Volume"Next shtEnd Sub